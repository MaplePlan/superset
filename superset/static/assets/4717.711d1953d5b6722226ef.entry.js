"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4717],{51127:e=>{var t=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,a){var l,o,s;return a=a||{},l=JSON.stringify([1],void 0,void 0===a.indent?2:a.indent).slice(2,-3),o=""===l?1/0:void 0===a.maxLength?80:a.maxLength,s=a.replacer,function e(a,r,n){var i,d,c,u,h,m,p,b,g,Z,f,v;if(a&&"function"==typeof a.toJSON&&(a=a.toJSON()),void 0===(f=JSON.stringify(a,s)))return f;if(p=o-r.length-n,f.length<=p&&(g=f.replace(t,(function(e,t){return t||e+" "}))).length<=p)return g;if(null!=s&&(a=JSON.parse(f),s=void 0),"object"==typeof a&&null!==a){if(b=r+l,c=[],d=0,Array.isArray(a))for(Z="[",i="]",p=a.length;d<p;d++)c.push(e(a[d],b,d===p-1?0:1)||"null");else for(Z="{",i="}",p=(m=Object.keys(a)).length;d<p;d++)u=m[d],h=JSON.stringify(u)+": ",void 0!==(v=e(a[u],b,h.length+(d===p-1?0:1)))&&c.push(h+v);if(c.length>0)return[Z,l+c.join(",\n"+b),i].join("\n"+r)}return f}(e,"",0)}},79789:(e,t,a)=>{a.d(t,{Z:()=>d});var l=a(67294),o=a(51995),s=a(61988),r=a(70163),n=a(58593),i=a(11965);const d=function(e){let{certifiedBy:t,details:a,size:d="l"}=e;const c=(0,o.Fg)();return(0,i.tZ)(n.u,{id:"certified-details-tooltip",title:(0,i.tZ)(l.Fragment,null,t&&(0,i.tZ)("div",null,(0,i.tZ)("strong",null,(0,s.t)("Certified by %s",t))),(0,i.tZ)("div",null,a))},(0,i.tZ)(r.Z.Certified,{iconColor:c.colors.primary.base,iconSize:d}))}},17198:(e,t,a)=>{a.d(t,{Z:()=>h});var l=a(51995),o=a(61988),s=a(67294),r=a(9875),n=a(74069),i=a(49238),d=a(11965);const c=l.iK.div`
  padding-top: 8px;
  width: 50%;
  label {
    color: ${e=>{let{theme:t}=e;return t.colors.grayscale.base}};
    text-transform: uppercase;
  }
`,u=l.iK.div`
  line-height: 40px;
  padding-top: 16px;
`;function h(e){let{description:t,onConfirm:a,onHide:l,open:h,title:m}=e;const[p,b]=(0,s.useState)(!0),[g,Z]=(0,s.useState)(""),f=()=>{Z(""),a()};return(0,d.tZ)(n.Z,{disablePrimaryButton:p,onHide:()=>{Z(""),l()},onHandledPrimaryAction:f,primaryButtonName:(0,o.t)("delete"),primaryButtonType:"danger",show:h,title:m},(0,d.tZ)(u,null,t),(0,d.tZ)(c,null,(0,d.tZ)(i.lX,{htmlFor:"delete"},(0,o.t)('Type "%s" to confirm',(0,o.t)("DELETE"))),(0,d.tZ)(r.II,{type:"text",id:"delete",autoComplete:"off",value:g,onChange:e=>{var t;const a=null!=(t=e.target.value)?t:"";b(a.toUpperCase()!==(0,o.t)("DELETE")),Z(a)},onPressEnter:()=>{p||f()}})))}},36674:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(67294),o=a(51995),s=a(11965),r=a(61988),n=a(58593),i=a(33626),d=a(70163);const c=o.iK.a`
  ${e=>{let{theme:t}=e;return s.iv`
    font-size: ${t.typography.sizes.xl}px;
    display: flex;
    padding: 0 0 0 ${2*t.gridUnit}px;
  `}};
`,u=e=>{let{itemId:t,isStarred:a,showTooltip:o,saveFaveStar:u,fetchFaveStar:h}=e;(0,i.J)((()=>{h&&h(t)}));const m=(0,l.useCallback)((e=>{e.preventDefault(),u(t,!!a)}),[a,t,u]),p=(0,s.tZ)(c,{href:"#",onClick:m,className:"fave-unfave-icon",role:"button"},a?(0,s.tZ)(d.Z.FavoriteSelected,null):(0,s.tZ)(d.Z.FavoriteUnselected,null));return o?(0,s.tZ)(n.u,{id:"fave-unfave-tooltip",title:(0,r.t)("Click to favorite/unfavorite")},p):p}},4144:(e,t,a)=>{a.d(t,{Z:()=>c});var l=a(5872),o=a.n(l),s=a(67294),r=a(51995),n=a(68492),i=a(11965);const d=r.iK.div`
  background-image: url(${e=>{let{src:t}=e;return t}});
  background-size: cover;
  background-position: center ${e=>{let{position:t}=e;return t}};
  display: inline-block;
  height: calc(100% - 1px);
  width: calc(100% - 2px);
  margin: 1px 1px 0 1px;
`;function c(e){let{src:t,fallback:a,isLoading:l,position:r,...c}=e;const[u,h]=(0,s.useState)(a);return(0,s.useEffect)((()=>(t&&fetch(t).then((e=>e.blob())).then((e=>{if(/image/.test(e.type)){const t=URL.createObjectURL(e);h(t)}})).catch((e=>{n.Z.error(e),h(a)})),()=>{h(a)})),[t,a]),(0,i.tZ)(d,o()({src:l?a:u},c,{position:r}))}},20818:(e,t,a)=>{a.d(t,{Z:()=>E});var l=a(78580),o=a.n(l),s=a(67294),r=a(9875),n=a(49238),i=a(51127),d=a.n(i),c=a(35932),u=a(4715),h=a(15926),m=a.n(h),p=a(51995),b=a(61988),g=a(81545),Z=a(31069),f=a(55786),v=a(78161),y=a(74069),C=a(94670),S=a(45697),_=a.n(S),x=a(93962),w=a(11965);const k={onChange:_().func,labelMargin:_().number,colorScheme:_().string,hasCustomLabelColors:_().bool};class J extends s.PureComponent{constructor(e){super(e),this.state={hovered:!1},this.categoricalSchemeRegistry=(0,g.Z)(),this.choices=this.categoricalSchemeRegistry.keys().map((e=>[e,e])),this.schemes=this.categoricalSchemeRegistry.getMap()}setHover(e){this.setState({hovered:e})}render(){const{colorScheme:e,labelMargin:t=0,hasCustomLabelColors:a}=this.props;return(0,w.tZ)(x.Z,{description:(0,b.t)("Any color palette selected here will override the colors applied to this dashboard's individual charts"),labelMargin:t,name:"color_scheme",onChange:this.props.onChange,value:e,choices:this.choices,clearable:!0,schemes:this.schemes,hovered:this.state.hovered,hasCustomLabelColors:a})}}J.propTypes=k,J.defaultProps={hasCustomLabelColors:!1,colorScheme:void 0,onChange:()=>{}};const N=J;var O=a(98286),T=a(14114),X=a(91877),A=a(93185);const j=(0,p.iK)(n.xJ)`
  margin-bottom: 0;
`,L=(0,p.iK)(C.Ad)`
  border-radius: ${e=>{let{theme:t}=e;return t.borderRadius}}px;
  border: 1px solid ${e=>{let{theme:t}=e;return t.colors.secondary.light2}};
`,E=(0,T.ZP)((e=>{let{addSuccessToast:t,addDangerToast:a,colorScheme:l,dashboardId:i,dashboardInfo:h,dashboardTitle:p,onHide:S=(()=>{}),onlyApply:_=!1,onSubmit:x=(()=>{}),show:k=!1}=e;const[J]=u.qz.useForm(),[T,E]=(0,s.useState)(!1),[F,I]=(0,s.useState)(!1),[B,R]=(0,s.useState)(l),[$,D]=(0,s.useState)(""),[M,z]=(0,s.useState)(),[P,q]=(0,s.useState)([]),[H,U]=(0,s.useState)([]),K=_?(0,b.t)("Apply"):(0,b.t)("Save"),V=(0,g.Z)(),G=async e=>{const{error:t,statusText:a,message:l}=await(0,O.O)(e);let o=t||a||(0,b.t)("An error has occurred");"object"==typeof l&&"json_metadata"in l?o=l.json_metadata:"string"==typeof l&&(o=l,"Forbidden"===l&&(o=(0,b.t)("You do not have permission to edit this dashboard"))),y.Z.error({title:"Error",content:o,okButtonProps:{danger:!0,className:"btn-danger"}})},W=(0,s.useCallback)((function(e,t,a,l){void 0===e&&(e="owners"),void 0===t&&(t="");const o=m().encode({filter:t,page:a,page_size:l});return Z.Z.get({endpoint:`/api/v1/dashboard/related/${e}?q=${o}`}).then((e=>({data:e.json.result.map((e=>({value:e.value,label:e.text}))),totalCount:e.json.count})))}),[]),Y=(0,s.useCallback)((e=>{const{id:t,dashboard_title:a,slug:l,certified_by:o,certification_details:s,owners:r,roles:n,metadata:i,is_managed_externally:c}=e,u={id:t,title:a,slug:l||"",certifiedBy:o||"",certificationDetails:s||"",isManagedExternally:c||!1};J.setFieldsValue(u),z(u),q(r),U(n),R(i.color_scheme),null!=i&&i.positions&&delete i.positions;const h={...i};null!=h&&h.shared_label_colors&&delete h.shared_label_colors,delete h.color_scheme_domain,D(h?d()(h):"")}),[J]),Q=(0,s.useCallback)((()=>{E(!0),Z.Z.get({endpoint:`/api/v1/dashboard/${i}`}).then((e=>{var t;const a=e.json.result,l=null!=(t=a.json_metadata)&&t.length?JSON.parse(a.json_metadata):{};Y({...a,metadata:l}),E(!1)}),G)}),[i,Y]),ee=()=>{try{return null!=$&&$.length?JSON.parse($):{}}catch(e){return{}}},te=e=>{const t=(0,f.Z)(e).map((e=>({id:e.value,full_name:e.label})));q(t)},ae=e=>{const t=(0,f.Z)(e).map((e=>({id:e.value,name:e.label})));U(t)},le=()=>(P||[]).map((e=>({value:e.id,label:e.full_name||`${e.first_name} ${e.last_name}`}))),oe=function(e,t){let{updateMetadata:a=!0}=void 0===t?{}:t;const l=V.keys(),s=ee();if(e&&!o()(l).call(l,e))throw y.Z.error({title:"Error",content:(0,b.t)("A valid color scheme is required"),okButtonProps:{danger:!0,className:"btn-danger"}}),new Error("A valid color scheme is required");a&&(s.color_scheme=e,s.label_colors=s.label_colors||{},D(d()(s))),R(e)};return(0,s.useEffect)((()=>{k&&(h?Y(h):Q()),C.Ad.preload()}),[h,Q,Y,k]),(0,s.useEffect)((()=>{p&&M&&M.title!==p&&J.setFieldsValue({...M,title:p})}),[M,p,J]),(0,w.tZ)(y.Z,{show:k,onHide:S,title:(0,b.t)("Dashboard properties"),footer:(0,w.tZ)(s.Fragment,null,(0,w.tZ)(c.Z,{htmlType:"button",buttonSize:"small",onClick:S,cta:!0},(0,b.t)("Cancel")),(0,w.tZ)(c.Z,{onClick:J.submit,buttonSize:"small",buttonStyle:"primary",className:"m-r-5",cta:!0,disabled:null==M?void 0:M.isManagedExternally,tooltip:null!=M&&M.isManagedExternally?(0,b.t)("This dashboard is managed externally, and can't be edited in Superset"):""},K)),responsive:!0},(0,w.tZ)(u.qz,{form:J,onFinish:()=>{var e;const{title:l,slug:o,certifiedBy:s,certificationDetails:r}=J.getFieldsValue();let n=B,c="",u=$;if(null!=(e=u)&&e.length){var h,m,p,g,f;let e;try{e=JSON.parse(u)}catch(e){a((0,b.t)("JSON metadata is invalid!"))}n=(null==(h=e)?void 0:h.color_scheme)||B,c=(null==(m=e)?void 0:m.color_namespace)||"",null!=(p=e)&&p.shared_label_colors&&delete e.shared_label_colors,null!=(g=e)&&g.color_scheme_domain&&delete e.color_scheme_domain;const t=(0,v.Z)().getColorMap(c,n,!0);var y;e.shared_label_colors=t,null!=(f=e)&&f.color_scheme?e.color_scheme_domain=(null==(y=V.get(B))?void 0:y.colors)||[]:e.color_scheme_domain=[],u=d()(e)}oe(n,{updateMetadata:!1});const C={},w={};(0,X.cr)(A.T.DASHBOARD_RBAC)&&(C.roles=H,w.roles=(H||[]).map((e=>e.id)));const k={id:i,title:l,slug:o,jsonMetadata:u,owners:P,colorScheme:n,colorNamespace:c,certifiedBy:s,certificationDetails:r,...C};_?(t((0,b.t)("Dashboard properties updated")),x(k),S()):Z.Z.put({endpoint:`/api/v1/dashboard/${i}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({dashboard_title:l,slug:o||null,json_metadata:u||null,owners:(P||[]).map((e=>e.id)),certified_by:s||null,certification_details:s&&r?r:null,...w})}).then((()=>{t((0,b.t)("The dashboard has been saved")),x(k),S()}),G)},layout:"vertical",initialValues:M},(0,w.tZ)(u.X2,null,(0,w.tZ)(u.JX,{xs:24,md:24},(0,w.tZ)("h3",null,(0,b.t)("Basic information")))),(0,w.tZ)(u.X2,{gutter:16},(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(n.xJ,{label:(0,b.t)("Title"),name:"title"},(0,w.tZ)(r.II,{type:"text",disabled:T}))),(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(j,{label:(0,b.t)("URL slug"),name:"slug"},(0,w.tZ)(r.II,{type:"text",disabled:T})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("A readable URL for your dashboard")))),(0,X.cr)(A.T.DASHBOARD_RBAC)?(()=>{const e=ee(),t=!!Object.keys((null==e?void 0:e.label_colors)||{}).length;return(0,w.tZ)(s.Fragment,null,(0,w.tZ)(u.X2,null,(0,w.tZ)(u.JX,{xs:24,md:24},(0,w.tZ)("h3",{style:{marginTop:"1em"}},(0,b.t)("Access")))),(0,w.tZ)(u.X2,{gutter:16},(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(j,{label:(0,b.t)("Owners")},(0,w.tZ)(u.qb,{allowClear:!0,ariaLabel:(0,b.t)("Owners"),disabled:T,mode:"multiple",onChange:te,options:(e,t,a)=>W("owners",e,t,a),value:le()})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("Owners is a list of users who can alter the dashboard. Searchable by name or username."))),(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(j,{label:(0,b.t)("Roles")},(0,w.tZ)(u.qb,{allowClear:!0,ariaLabel:(0,b.t)("Roles"),disabled:T,mode:"multiple",onChange:ae,options:(e,t,a)=>W("roles",e,t,a),value:(H||[]).map((e=>({value:e.id,label:`${e.name}`})))})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("Roles is a list which defines access to the dashboard. Granting a role access to a dashboard will bypass dataset level checks. If no roles are defined, then the dashboard is available to all roles.")))),(0,w.tZ)(u.X2,null,(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(N,{hasCustomLabelColors:t,onChange:oe,colorScheme:B,labelMargin:4}))))})():(()=>{const e=ee(),t=!!Object.keys((null==e?void 0:e.label_colors)||{}).length;return(0,w.tZ)(u.X2,{gutter:16},(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)("h3",{style:{marginTop:"1em"}},(0,b.t)("Access")),(0,w.tZ)(j,{label:(0,b.t)("Owners")},(0,w.tZ)(u.qb,{allowClear:!0,ariaLabel:(0,b.t)("Owners"),disabled:T,mode:"multiple",onChange:te,options:(e,t,a)=>W("owners",e,t,a),value:le()})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("Owners is a list of users who can alter the dashboard. Searchable by name or username."))),(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)("h3",{style:{marginTop:"1em"}},(0,b.t)("Colors")),(0,w.tZ)(N,{hasCustomLabelColors:t,onChange:oe,colorScheme:B,labelMargin:4})))})(),(0,w.tZ)(u.X2,null,(0,w.tZ)(u.JX,{xs:24,md:24},(0,w.tZ)("h3",null,(0,b.t)("Certification")))),(0,w.tZ)(u.X2,{gutter:16},(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(j,{label:(0,b.t)("Certified by"),name:"certifiedBy"},(0,w.tZ)(r.II,{type:"text",disabled:T})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("Person or group that has certified this dashboard."))),(0,w.tZ)(u.JX,{xs:24,md:12},(0,w.tZ)(j,{label:(0,b.t)("Certification details"),name:"certificationDetails"},(0,w.tZ)(r.II,{type:"text",disabled:T})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("Any additional detail to show in the certification tooltip.")))),(0,w.tZ)(u.X2,null,(0,w.tZ)(u.JX,{xs:24,md:24},(0,w.tZ)("h3",{style:{marginTop:"1em"}},(0,w.tZ)(c.Z,{buttonStyle:"link",onClick:()=>I(!F)},(0,w.tZ)("i",{className:"fa fa-angle-"+(F?"down":"right"),style:{minWidth:"1em"}}),(0,b.t)("Advanced"))),F&&(0,w.tZ)(s.Fragment,null,(0,w.tZ)(j,{label:(0,b.t)("JSON metadata")},(0,w.tZ)(L,{showLoadingForImport:!0,name:"json_metadata",value:$,onChange:D,tabSize:2,width:"100%",height:"200px",wrapEnabled:!0})),(0,w.tZ)("p",{className:"help-block"},(0,b.t)("This JSON object is generated dynamically when clicking the save or overwrite button in the dashboard view. It is exposed here for reference and for power users who may want to alter specific parameters.")))))))}))},33626:(e,t,a)=>{a.d(t,{J:()=>o});var l=a(67294);const o=e=>{(0,l.useEffect)(e,[])}}}]);
//# sourceMappingURL=4717.711d1953d5b6722226ef.entry.js.map