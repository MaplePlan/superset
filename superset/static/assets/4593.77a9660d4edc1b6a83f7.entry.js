"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4593],{82607:(e,t,a)=>{a.d(t,{Z:()=>s}),a(67294);var n=a(51995),l=a(62529),o=a(11965);const s=(0,n.iK)((e=>{let{textColor:t,...a}=e;return(0,o.tZ)(l.Z,a)}))`
  & > sup {
    padding: 0 ${e=>{let{theme:t}=e;return 2*t.gridUnit}}px;
    background: ${e=>{let{theme:t,color:a}=e;return a||t.colors.primary.base}};
    color: ${e=>{let{theme:t,textColor:a}=e;return a||t.colors.grayscale.light5}};
  }
`},57011:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(5872),l=a.n(n),o=(a(67294),a(70302)),s=a(11965);const i=e=>{let{padded:t,...a}=e;return(0,s.tZ)(o.Z,l()({},a,{css:e=>({backgroundColor:e.colors.grayscale.light4,borderRadius:e.borderRadius,".ant-card-body":{padding:t?4*e.gridUnit:e.gridUnit}})}))}},79789:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(67294),l=a(51995),o=a(61988),s=a(70163),i=a(58593),r=a(11965);const d=function(e){let{certifiedBy:t,details:a,size:d="l"}=e;const c=(0,l.Fg)();return(0,r.tZ)(i.u,{id:"certified-details-tooltip",title:(0,r.tZ)(n.Fragment,null,t&&(0,r.tZ)("div",null,(0,r.tZ)("strong",null,(0,o.t)("Certified by %s",t))),(0,r.tZ)("div",null,a))},(0,r.tZ)(s.Z.Certified,{iconColor:c.colors.primary.base,iconSize:d}))}},73995:(e,t,a)=>{a.d(t,{Z:()=>v});var n=a(67294),l=a(51995),o=a(31069),s=a(61988),i=a(15926),r=a.n(i),d=a(4715),c=a(37921),u=a(49238),m=a(40277),b=a(14114),h=a(11965);const p=l.iK.div`
  ${e=>{let{theme:t}=e;return`\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${t.gridUnit}px;\n      margin-top: ${5*t.gridUnit}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .select {\n      width: calc(100% - 30px - ${t.gridUnit}px);\n      flex: 1;\n    }\n\n    & > div {\n      margin-bottom: ${4*t.gridUnit}px;\n    }\n  `}}
`,g=l.iK.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-left: ${e=>{let{theme:t}=e;return t.gridUnit-2}}px;

  .backend {
    overflow: visible;
  }

  .name {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,f=e=>{let{backend:t,databaseName:a}=e;return(0,h.tZ)(g,null,(0,h.tZ)(c.Z,{className:"backend"},t),(0,h.tZ)("span",{className:"name",title:a},a))};function v(e){let{db:t,formMode:a=!1,emptyState:l,getDbList:i,handleError:c,isDatabaseSelectEnabled:g=!0,onDbChange:v,onEmptyResults:Z,onSchemaChange:S,onSchemasLoad:y,readOnly:x=!1,schema:w,sqlLabMode:C=!1}=e;const[_,k]=(0,n.useState)(!1),[$,L]=(0,n.useState)([]),[E,U]=(0,n.useState)(t?{label:(0,h.tZ)(f,{backend:t.backend,databaseName:t.database_name}),value:t.id,...t}:void 0),[N,M]=(0,n.useState)(w?{label:w,value:w}:void 0),[D,T]=(0,n.useState)(0),{addSuccessToast:R}=(0,b.e1)(),q=(0,n.useMemo)((()=>async(e,t,n)=>{const l=`/api/v1/database/?q=${r().encode({order_columns:"database_name",order_direction:"asc",page:t,page_size:n,...a||!C?{filters:[{col:"database_name",opr:"ct",value:e}]}:{filters:[{col:"database_name",opr:"ct",value:e},{col:"expose_in_sqllab",opr:"eq",value:!0}]}})}`;return o.Z.get({endpoint:l}).then((t=>{let{json:a}=t;const{result:n}=a;i&&i(n),0===n.length&&Z&&Z(e);const l=n.map((e=>({label:(0,h.tZ)(f,{backend:e.backend,databaseName:e.database_name}),value:e.id,id:e.id,database_name:e.database_name,backend:e.backend,allow_multi_schema_metadata_fetch:e.allow_multi_schema_metadata_fetch})));return{data:l,totalCount:l.length}}))}),[a,i,C]);function z(e,t){return(0,h.tZ)("div",{className:"section"},(0,h.tZ)("span",{className:"select"},e),(0,h.tZ)("span",{className:"refresh"},t))}return(0,n.useEffect)((()=>{if(E){k(!0);const e=r().encode({force:D>0}),t=`/api/v1/database/${E.value}/schemas/?q=${e}`;o.Z.get({endpoint:t}).then((e=>{let{json:t}=e;const a=t.result.map((e=>({value:e,label:e,title:e})));y&&y(a),L(a),k(!1),D>0&&R("List refreshed")})).catch((()=>{k(!1),c((0,s.t)("There was an error loading the schemas"))}))}}),[E,y,D]),(0,h.tZ)(p,null,z((0,h.tZ)(d.qb,{ariaLabel:(0,s.t)("Select database or type database name"),optionFilterProps:["database_name","value"],header:(0,h.tZ)(u.lX,null,(0,s.t)("Database")),lazyLoading:!1,notFoundContent:l,onChange:function(e,t){U(t),M(void 0),v&&v(t),S&&S(void 0)},value:E,placeholder:(0,s.t)("Select database or type database name"),disabled:!g||x,options:q}),null),function(){const e=!a&&!x&&(0,h.tZ)(m.Z,{onClick:()=>T(D+1),tooltipContent:(0,s.t)("Force refresh schema list")});return z((0,h.tZ)(d.Ph,{ariaLabel:(0,s.t)("Select schema or type schema name"),disabled:!E||x,header:(0,h.tZ)(u.lX,null,(0,s.t)("Schema")),labelInValue:!0,loading:_,name:"select-schema",placeholder:(0,s.t)("Select schema or type schema name"),onChange:e=>function(e){M(e),S&&S(e.value)}(e),options:$,showSearch:!0,value:N}),e)}())}},40277:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(67294),l=a(58593),o=a(70163),s=a(11965);const i=e=>{let{onClick:t,tooltipContent:a}=e;const i=(0,n.forwardRef)(((e,t)=>(0,s.tZ)(o.Z.Refresh,e)));return(0,s.tZ)(l.u,{title:a},(0,s.tZ)(i,{role:"button",onClick:t,css:e=>({cursor:"pointer",color:e.colors.grayscale.base,"&:hover":{color:e.colors.primary.base}})}))}},17982:(e,t,a)=>{a.d(t,{P:()=>C,Z:()=>_});var n=a(5872),l=a.n(n),o=a(78580),s=a.n(o),i=a(67294),r=a(51995),d=a(31069),c=a(61988),u=a(4715),m=a(49238),b=a(70163),h=a(73995),p=a(40277),g=a(79789),f=a(86057),v=a(14114),Z=a(11965);const S=r.iK.div`
  ${e=>{let{theme:t}=e;return`\n    .refresh {\n      display: flex;\n      align-items: center;\n      width: 30px;\n      margin-left: ${t.gridUnit}px;\n      margin-top: ${5*t.gridUnit}px;\n    }\n\n    .section {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    .divider {\n      border-bottom: 1px solid ${t.colors.secondary.light5};\n      margin: 15px 0;\n    }\n\n    .table-length {\n      color: ${t.colors.grayscale.light1};\n    }\n\n    .select {\n      flex: 1;\n    }\n  `}}
`,y=r.iK.span`
  align-items: center;
  display: flex;
  white-space: nowrap;

  svg,
  small {
    margin-right: ${e=>{let{theme:t}=e;return t.gridUnit}}px;
  }
`,x=e=>{let{table:t}=e;const{label:a,type:n,extra:l}=t;return(0,Z.tZ)(y,{title:a},"view"===n?(0,Z.tZ)(b.Z.Eye,{iconSize:"m"}):(0,Z.tZ)(b.Z.Table,{iconSize:"m"}),(null==l?void 0:l.certification)&&(0,Z.tZ)(g.Z,{certifiedBy:l.certification.certified_by,details:l.certification.details,size:"l"}),(null==l?void 0:l.warning_markdown)&&(0,Z.tZ)(f.Z,{warningMarkdown:l.warning_markdown,size:"l"}),a)},w=e=>{let{database:t,emptyState:a,formMode:n=!1,getDbList:l,handleError:o,isDatabaseSelectEnabled:r=!0,onDbChange:b,onSchemaChange:g,onSchemasLoad:f,onTablesLoad:y,readOnly:w=!1,onEmptyResults:C,schema:_,sqlLabMode:k=!0,tableSelectMode:$="single",tableValue:L,onTableSelectChange:E}=e;const[U,N]=(0,i.useState)(t),[M,D]=(0,i.useState)(_),[T,R]=(0,i.useState)([]),[q,z]=(0,i.useState)(void 0),[F,K]=(0,i.useState)(0),[I,O]=(0,i.useState)(0),[P,X]=(0,i.useState)(!1),{addSuccessToast:j}=(0,v.e1)();(0,i.useEffect)((()=>{void 0===t&&(N(void 0),D(void 0),z(void 0))}),[t,$]),(0,i.useEffect)((()=>{N(t)}),[t]),(0,i.useEffect)((()=>{z("single"===$?T.find((e=>e.value===L)):(null==T?void 0:T.filter((e=>e&&(null==L?void 0:s()(L).call(L,e.value)))))||[])}),[T,L,$]),(0,i.useEffect)((()=>{if(U&&M){X(!0);const e=encodeURIComponent(M),t=F!==I,a=encodeURI(`/superset/tables/${U.id}/${e}/undefined/${t}/`);I!==F&&O(F),d.Z.get({endpoint:a}).then((e=>{let{json:a}=e;const n=a.options.map((e=>({value:e.value,label:(0,Z.tZ)(x,{table:e}),text:e.label})));null==y||y(a.options),R(n),X(!1),t&&j("List updated")})).catch((()=>{X(!1),o((0,c.t)("There was an error loading the tables"))}))}}),[U,M,y,R,F]);const V=e=>{M?null==E||E(Array.isArray(e)?e.map((e=>null==e?void 0:e.value)):null==e?void 0:e.value,M):z(e)},A=(0,i.useMemo)((()=>(e,t)=>{var a;const n=e.trim().toLowerCase(),{text:l}=t;return s()(a=l.toLowerCase()).call(a,n)}),[]);return(0,Z.tZ)(S,null,(0,Z.tZ)(h.Z,{key:null==U?void 0:U.id,db:U,emptyState:a,formMode:n,getDbList:l,handleError:o,onDbChange:w?void 0:e=>{N(e),b&&b(e)},onEmptyResults:C,onSchemaChange:w?void 0:e=>{D(e),g&&g(e),V(void 0)},onSchemasLoad:f,schema:M,sqlLabMode:k,isDatabaseSelectEnabled:r&&!w,readOnly:w}),k&&!n&&(0,Z.tZ)("div",{className:"divider"}),function(){const e=M&&!n&&w||!M&&!(null!=t&&t.allow_multi_schema_metadata_fetch),a=k?(0,Z.tZ)(m.lX,null,(0,c.t)("See table schema")):(0,Z.tZ)(m.lX,null,(0,c.t)("Table"));return l=(0,Z.tZ)(u.Ph,{ariaLabel:(0,c.t)("Select table or type table name"),disabled:e,filterOption:A,header:a,labelInValue:!0,loading:P,name:"select-table",onChange:e=>V(e),options:T,placeholder:(0,c.t)("Select table or type table name"),showSearch:!0,mode:$,value:q,allowClear:"multiple"===$}),o=!n&&!w&&(0,Z.tZ)(p.Z,{onClick:()=>K(F+1),tooltipContent:(0,c.t)("Force refresh table list")}),(0,Z.tZ)("div",{className:"section"},(0,Z.tZ)("span",{className:"select"},l),(0,Z.tZ)("span",{className:"refresh"},o));var l,o}())},C=e=>(0,Z.tZ)(w,l()({tableSelectMode:"multiple"},e)),_=w}}]);
//# sourceMappingURL=4593.77a9660d4edc1b6a83f7.entry.js.map