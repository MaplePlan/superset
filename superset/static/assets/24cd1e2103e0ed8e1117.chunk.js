"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[704],{33738:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(78580),a=r.n(n),l=r(67294),s=r(63475),u=r(6915),c=r(11965);function i(e){let{height:t,width:r,echartOptions:n,setDataMask:i,labelMap:o,labelMapB:h,groupby:d,groupbyB:f,selectedValues:p,formData:g,seriesBreakdown:m,onContextMenu:v,xValueFormatter:b}=e;const w=(0,l.useCallback)((e=>e<m),[m]),k=(0,l.useCallback)(((e,t)=>{if(!(w(t)?g.emitFilter:g.emitFilterB))return;const r=w(t)?d:f,n=w(t)?o:h,a=e.map((e=>n[e])).filter((e=>!!e));i({extraFormData:{filters:0===e.length?[]:[...r.map(((e,t)=>{const r=a.map((e=>e[t]));return null==r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}}))]},filterState:{value:a.length?a:null,selectedValues:e.length?e:null}})}),[d,f,o,h,i,p]),y={click:e=>{const{seriesName:t,seriesIndex:r}=e,n=Object.values(p);a()(n).call(n,t)?k(n.filter((e=>e!==t)),r):k([t],r)},mouseout:()=>{u.aI.name=""},mouseover:e=>{u.aI.name=e.seriesName},contextmenu:e=>{if(v){e.event.stop();const{data:t,seriesIndex:r}=e;if(t){const a=e.event.event,l=o[e.seriesName],{queryIndex:s}=n.series[r],u=s>0?g.groupbyB:g.groupby,c=[];c.push({col:g.granularitySqla,grain:g.timeGrainSqla,op:"==",val:t[0],formattedVal:b(t[0])}),u.forEach(((e,t)=>c.push({col:e,op:"==",val:l[t],formattedVal:String(l[t])}))),v(c,a.clientX,a.clientY)}}}};return(0,c.tZ)(s.Z,{height:t,width:r,echartOptions:n,eventHandlers:y,selectedValues:p})}},63475:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(78580),a=r.n(n),l=r(67294),s=r(51995),u=r(29027),c=r(11965);const i=s.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function o(e,t){let{width:r,height:n,echartOptions:s,eventHandlers:o,zrEventHandlers:h,selectedValues:d={}}=e;const f=(0,l.useRef)(null),p=(0,l.useRef)(),g=(0,l.useMemo)((()=>Object.keys(d)||[]),[d]),m=(0,l.useRef)([]);(0,l.useImperativeHandle)(t,(()=>({getEchartInstance:()=>p.current}))),(0,l.useEffect)((()=>{f.current&&(p.current||(p.current=(0,u.S1)(f.current)),Object.entries(o||{}).forEach((e=>{var t,r;let[n,a]=e;null==(t=p.current)||t.off(n),null==(r=p.current)||r.on(n,a)})),Object.entries(h||{}).forEach((e=>{var t,r;let[n,a]=e;null==(t=p.current)||t.getZr().off(n),null==(r=p.current)||r.getZr().on(n,a)})),p.current.setOption(s,!0))}),[s,o,h]),(0,l.useEffect)((()=>{p.current&&(p.current.dispatchAction({type:"downplay",dataIndex:m.current.filter((e=>!a()(g).call(g,e)))}),g.length&&p.current.dispatchAction({type:"highlight",dataIndex:g}),m.current=g)}),[g]);const v=(0,l.useCallback)((e=>{let{width:t,height:r}=e;p.current&&p.current.resize({width:t,height:r})}),[]);return(0,l.useEffect)((()=>{v({width:r,height:n})}),[]),(0,l.useLayoutEffect)((()=>{v({width:r,height:n})}),[r,n,v]),(0,c.tZ)(i,{ref:f,height:n,width:r})}const h=(0,l.forwardRef)(o)}}]);
//# sourceMappingURL=24cd1e2103e0ed8e1117.chunk.js.map