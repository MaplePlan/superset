"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7974],{27974:(t,e,o)=>{o.r(e),o.d(e,{default:()=>Y});var r=o(78580),a=o.n(r),s=o(67294);const l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"plus-square",theme:"outlined"};var n=o(27029),i=function(t,e){return s.createElement(n.Z,Object.assign({},t,{ref:e,icon:l}))};i.displayName="PlusSquareOutlined";const c=s.forwardRef(i),h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"minus-square",theme:"outlined"};var u=function(t,e){return s.createElement(n.Z,Object.assign({},t,{ref:e,icon:h}))};u.displayName="MinusSquareOutlined";const p=s.forwardRef(u);var g=o(51995),d=o(67190),m=o(10581),f=o(72813),b=o(45697),v=o.n(b),y=o(61988);const w=function(t){const e={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",...t};return function(t){if(Number.isNaN(t)||!Number.isFinite(t))return"";const o=function(t,e,o){const r=String(t).split(".");let a=r[0];const s=r.length>1?o+r[1]:"",l=/(\d+)(\d{3})/;for(;l.test(a);)a=a.replace(l,`$1${e}$2`);return a+s}((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep);return`${e.prefix}${o}${e.suffix}`}},k=/(\d+)|(\D+)/g,C=/\d/,T=/^0/,S=(t,e)=>{if(null!==e&&null===t)return-1;if(null!==t&&null===e)return 1;if("number"==typeof t&&Number.isNaN(t))return-1;if("number"==typeof e&&Number.isNaN(e))return 1;const o=Number(t),r=Number(e);if(o<r)return-1;if(o>r)return 1;if("number"==typeof t&&"number"!=typeof e)return-1;if("number"==typeof e&&"number"!=typeof t)return 1;if("number"==typeof t&&"number"==typeof e)return 0;if(Number.isNaN(r)&&!Number.isNaN(o))return-1;if(Number.isNaN(o)&&!Number.isNaN(r))return 1;let a=String(t),s=String(e);if(a===s)return 0;if(!C.test(a)||!C.test(s))return a>s?1:-1;for(a=a.match(k),s=s.match(k);a.length&&s.length;){const t=a.shift(),e=s.shift();if(t!==e)return C.test(t)&&C.test(e)?t.replace(T,".0")-e.replace(T,".0"):t>e?1:-1}return a.length-s.length},O=function(t){const e={},o={};return t.forEach(((t,r)=>{e[t]=r,"string"==typeof t&&(o[t.toLowerCase()]=r)})),function(t,r){return t in e&&r in e?e[t]-e[r]:t in e?-1:r in e?1:t in o&&r in o?o[t]-o[r]:t in o?-1:r in o?1:S(t,r)}},x=function(t,e){if(t)if("function"==typeof t){const o=t(e);if("function"==typeof o)return o}else if(e in t)return t[e];return S},N=w(),A=w({digitsAfterDecimal:0}),M=w({digitsAfterDecimal:1,scaler:100,suffix:"%"}),H=t=>e=>"string"==typeof e?e:t(e),R={count:t=>(void 0===t&&(t=A),()=>function(){return{count:0,push(){this.count+=1},value(){return this.count},format:t}}),uniques:(t,e)=>(void 0===e&&(e=A),function(o){let[r]=o;return function(){return{uniq:[],push(t){var e;a()(e=Array.from(this.uniq)).call(e,t[r])||this.uniq.push(t[r])},value(){return t(this.uniq)},format:H(e),numInputs:void 0!==r?0:1}}}),sum:t=>(void 0===t&&(t=N),function(e){let[o]=e;return function(){return{sum:0,push(t){Number.isNaN(Number(t[o]))?this.sum=t[o]:this.sum+=parseFloat(t[o])},value(){return this.sum},format:H(t),numInputs:void 0!==o?0:1}}}),extremes:(t,e)=>(void 0===e&&(e=N),function(o){let[r]=o;return function(o){return{val:null,sorter:x(void 0!==o?o.sorters:null,r),push(e){var o;const s=e[r];if(a()(o=["min","max"]).call(o,t)){const e=Number(s);Number.isNaN(e)?this.val=!this.val||"min"===t&&s<this.val||"max"===t&&s>this.val?s:this.val:this.val=Math[t](e,null!==this.val?this.val:e)}else("first"===t&&this.sorter(s,null!==this.val?this.val:s)<=0||"last"===t&&this.sorter(s,null!==this.val?this.val:s)>=0)&&(this.val=s)},value(){return this.val},format:t=>"number"==typeof t?e(t):t,numInputs:void 0!==r?0:1}}}),quantile:(t,e)=>(void 0===e&&(e=N),function(o){let[r]=o;return function(){return{vals:[],strMap:{},push(t){const e=t[r],o=Number(e);Number.isNaN(o)?this.strMap[e]=(this.strMap[e]||0)+1:this.vals.push(o)},value(){if(0===this.vals.length&&0===Object.keys(this.strMap).length)return null;if(Object.keys(this.strMap).length){const t=Object.values(this.strMap).sort(((t,e)=>t-e)),e=Math.floor(t.length/2),o=Object.keys(this.strMap);return o.length%2!=0?o[e]:(o[e-1]+o[e])/2}this.vals.sort(((t,e)=>t-e));const e=(this.vals.length-1)*t;return(this.vals[Math.floor(e)]+this.vals[Math.ceil(e)])/2},format:H(e),numInputs:void 0!==r?0:1}}}),runningStat:(t,e,o)=>(void 0===t&&(t="mean"),void 0===e&&(e=1),void 0===o&&(o=N),function(r){let[a]=r;return function(){return{n:0,m:0,s:0,strValue:null,push(t){const e=Number(t[a]);if(Number.isNaN(e))return void(this.strValue="string"==typeof t[a]?t[a]:this.strValue);this.n+=1,1===this.n&&(this.m=e);const o=this.m+(e-this.m)/this.n;this.s+=(e-this.m)*(e-o),this.m=o},value(){if(this.strValue)return this.strValue;if("mean"===t)return 0===this.n?NaN:this.m;if(this.n<=e)return 0;switch(t){case"var":return this.s/(this.n-e);case"stdev":return Math.sqrt(this.s/(this.n-e));default:throw new Error("unknown mode for runningStat")}},format:H(o),numInputs:void 0!==a?0:1}}}),sumOverSum:t=>(void 0===t&&(t=N),function(e){let[o,r]=e;return function(){return{sumNum:0,sumDenom:0,push(t){Number.isNaN(Number(t[o]))||(this.sumNum+=parseFloat(t[o])),Number.isNaN(Number(t[r]))||(this.sumDenom+=parseFloat(t[r]))},value(){return this.sumNum/this.sumDenom},format:t,numInputs:void 0!==o&&void 0!==r?0:2}}}),fractionOf:(t,e,o)=>(void 0===e&&(e="total"),void 0===o&&(o=M),function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return function(r,s,l){return{selector:{total:[[],[]],row:[s,[]],col:[[],l]}[e],inner:t(...Array.from(a||[]))(r,s,l),push(t){this.inner.push(t)},format:H(o),value(){const t=r.getAggregator(...Array.from(this.selector||[])).inner.value();return"string"==typeof t?t:this.inner.value()/t},numInputs:t(...Array.from(a||[]))().numInputs}}})},F={countUnique:t=>R.uniques((t=>t.length),t),listUnique:(t,e)=>R.uniques((e=>e.join(t)),e||(t=>t)),max:t=>R.extremes("max",t),min:t=>R.extremes("min",t),first:t=>R.extremes("first",t),last:t=>R.extremes("last",t),median:t=>R.quantile(.5,t),average:t=>R.runningStat("mean",1,t),var:(t,e)=>R.runningStat("var",t,e),stdev:(t,e)=>R.runningStat("stdev",t,e)},K={...R,...F},_={Count:($=K).count(A),"Count Unique Values":$.countUnique(A),"List Unique Values":$.listUnique(", "),Sum:$.sum(N),"Integer Sum":$.sum(A),Average:$.average(N),Median:$.median(N),"Sample Variance":$.var(1,N),"Sample Standard Deviation":$.stdev(1,N),Minimum:$.min(N),Maximum:$.max(N),First:$.first(N),Last:$.last(N),"Sum over Sum":$.sumOverSum(N),"Sum as Fraction of Total":$.fractionOf($.sum(),"total",M),"Sum as Fraction of Rows":$.fractionOf($.sum(),"row",M),"Sum as Fraction of Columns":$.fractionOf($.sum(),"col",M),"Count as Fraction of Total":$.fractionOf($.count(),"total",M),"Count as Fraction of Rows":$.fractionOf($.count(),"row",M),"Count as Fraction of Columns":$.fractionOf($.count(),"col",M)};var $;const E=t=>t.join(String.fromCharCode(0));class Z{constructor(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.props={...Z.defaultProps,...t},this.processRecord=this.processRecord.bind(this),v().checkPropTypes(Z.propTypes,this.props,"prop","PivotData"),this.aggregator=this.props.aggregatorsFactory(this.props.defaultFormatter)[this.props.aggregatorName](this.props.vals),this.formattedAggregators=this.props.customFormatters&&Object.entries(this.props.customFormatters).reduce(((t,e)=>{let[o,r]=e;return t[o]={},Object.entries(r).forEach((e=>{let[r,a]=e;t[o][r]=this.props.aggregatorsFactory(a)[this.props.aggregatorName](this.props.vals)})),t}),{}),this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.subtotals=e,this.sorted=!1,Z.forEachRecord(this.props.data,this.processRecord)}getFormattedAggregator(t,e){if(!this.formattedAggregators)return this.aggregator;const[o,r]=Object.entries(t).find((t=>{let[e,o]=t;return this.formattedAggregators[e]&&this.formattedAggregators[e][o]}))||[];return!o||!r||e&&!a()(e).call(e,r)?this.aggregator:this.formattedAggregators[o][r]||this.aggregator}arrSort(t,e,o){void 0===o&&(o=!1);const r=t.map((t=>x(this.props.sorters,t)));return function(t,a){const s=Math.min(t.length,a.length);for(let e=0;e<s;e+=1){const s=r[e],l=o?s(a[e],t[e]):s(t[e],a[e]);if(0!==l)return l}return e?t.length-a.length:a.length-t.length}}sortKeys(){if(!this.sorted){this.sorted=!0;const t=(t,e)=>this.getAggregator(t,e).value();switch(this.props.rowOrder){case"key_z_to_a":this.rowKeys.sort(this.arrSort(this.props.rows,this.subtotals.rowPartialOnTop,!0));break;case"value_a_to_z":this.rowKeys.sort(((e,o)=>S(t(e,[]),t(o,[]))));break;case"value_z_to_a":this.rowKeys.sort(((e,o)=>-S(t(e,[]),t(o,[]))));break;default:this.rowKeys.sort(this.arrSort(this.props.rows,this.subtotals.rowPartialOnTop))}switch(this.props.colOrder){case"key_z_to_a":this.colKeys.sort(this.arrSort(this.props.cols,this.subtotals.colPartialOnTop,!0));break;case"value_a_to_z":this.colKeys.sort(((e,o)=>S(t([],e),t([],o))));break;case"value_z_to_a":this.colKeys.sort(((e,o)=>-S(t([],e),t([],o))));break;default:this.colKeys.sort(this.arrSort(this.props.cols,this.subtotals.colPartialOnTop))}}}getColKeys(){return this.sortKeys(),this.colKeys}getRowKeys(){return this.sortKeys(),this.rowKeys}processRecord(t){const e=[],o=[];this.props.cols.forEach((o=>{e.push(o in t?t[o]:"null")})),this.props.rows.forEach((e=>{o.push(e in t?t[e]:"null")})),this.allTotal.push(t);const r=this.subtotals.rowEnabled?1:Math.max(1,o.length),a=this.subtotals.colEnabled?1:Math.max(1,e.length);let s,l;for(let e=r;e<=o.length;e+=1){s=e<o.length;const r=o.slice(0,e),a=E(r);this.rowTotals[a]||(this.rowKeys.push(r),this.rowTotals[a]=this.getFormattedAggregator(t,o)(this,r,[])),this.rowTotals[a].push(t),this.rowTotals[a].isSubtotal=s}for(let o=a;o<=e.length;o+=1){l=o<e.length;const r=e.slice(0,o),a=E(r);this.colTotals[a]||(this.colKeys.push(r),this.colTotals[a]=this.getFormattedAggregator(t,e)(this,[],r)),this.colTotals[a].push(t),this.colTotals[a].isSubtotal=l}for(let n=r;n<=o.length;n+=1){s=n<o.length;const r=o.slice(0,n),i=E(r);this.tree[i]||(this.tree[i]={});for(let o=a;o<=e.length;o+=1){l=o<e.length;const a=e.slice(0,o),n=E(a);this.tree[i][n]||(this.tree[i][n]=this.getFormattedAggregator(t)(this,r,a)),this.tree[i][n].push(t),this.tree[i][n].isRowSubtotal=s,this.tree[i][n].isColSubtotal=l,this.tree[i][n].isSubtotal=s||l}}}getAggregator(t,e){let o;const r=E(t),a=E(e);return o=0===t.length&&0===e.length?this.allTotal:0===t.length?this.colTotals[a]:0===e.length?this.rowTotals[r]:this.tree[r][a],o||{value:()=>null,format:()=>""}}}Z.forEachRecord=function(t,e){if(Array.isArray(t))return t.map((t=>e(t)));throw new Error((0,y.t)("Unknown input format"))},Z.defaultProps={aggregators:_,cols:[],rows:[],vals:[],aggregatorName:"Count",sorters:{},rowOrder:"key_a_to_z",colOrder:"key_a_to_z"},Z.propTypes={data:v().oneOfType([v().array,v().object,v().func]).isRequired,aggregatorName:v().string,cols:v().arrayOf(v().string),rows:v().arrayOf(v().string),vals:v().arrayOf(v().string),valueFilter:v().objectOf(v().objectOf(v().bool)),sorters:v().oneOfType([v().func,v().objectOf(v().func)]),derivedAttributes:v().objectOf(v().func),rowOrder:v().oneOf(["key_a_to_z","key_z_to_a","value_a_to_z","value_z_to_a"]),colOrder:v().oneOf(["key_a_to_z","key_z_to_a","value_a_to_z","value_z_to_a"])};var L=o(11965);const D=g.iK.div`
  ${t=>{let{theme:e}=t;return L.iv`
    table.pvtTable {
      position: relative;
      font-size: ${e.typography.sizes.s}px;
      text-align: left;
      margin: ${e.gridUnit}px;
      border-collapse: separate;
      font-family: ${e.typography.families.sansSerif};
      line-height: 1.4;
    }

    table thead {
      position: sticky;
      top: 0;
    }

    table tbody tr {
      font-feature-settings: 'tnum' 1;
    }

    table.pvtTable thead tr th,
    table.pvtTable tbody tr th {
      background-color: ${e.colors.grayscale.light5};
      border-top: 1px solid ${e.colors.grayscale.light2};
      border-left: 1px solid ${e.colors.grayscale.light2};
      font-size: ${e.typography.sizes.s}px;
      padding: ${e.gridUnit}px;
      font-weight: ${e.typography.weights.normal};
    }

    table.pvtTable tbody tr.pvtRowTotals {
      position: sticky;
      bottom: 0;
    }

    table.pvtTable thead tr:last-of-type th,
    table.pvtTable thead tr:first-of-type th.pvtTotalLabel,
    table.pvtTable thead tr:nth-last-of-type(2) th.pvtColLabel,
    table.pvtTable thead th.pvtSubtotalLabel,
    table.pvtTable tbody tr:last-of-type th,
    table.pvtTable tbody tr:last-of-type td {
      border-bottom: 1px solid ${e.colors.grayscale.light2};
    }

    table.pvtTable
      thead
      tr:last-of-type:not(:only-child)
      th.pvtAxisLabel
      ~ th.pvtColLabel,
    table.pvtTable tbody tr:first-of-type th,
    table.pvtTable tbody tr:first-of-type td {
      border-top: none;
    }

    table.pvtTable tbody tr td:last-of-type,
    table.pvtTable thead tr th:last-of-type:not(.pvtSubtotalLabel) {
      border-right: 1px solid ${e.colors.grayscale.light2};
    }

    table.pvtTable
      thead
      tr:last-of-type:not(:only-child)
      th.pvtAxisLabel
      + .pvtTotalLabel {
      border-right: none;
    }

    table.pvtTable tr th.active {
      background-color: ${e.colors.primary.light3};
    }

    table.pvtTable .pvtTotalLabel {
      text-align: right;
      font-weight: ${e.typography.weights.bold};
    }

    table.pvtTable .pvtSubtotalLabel {
      font-weight: ${e.typography.weights.bold};
    }

    table.pvtTable tbody tr td {
      color: ${e.colors.primary.dark2};
      padding: ${e.gridUnit}px;
      background-color: ${e.colors.grayscale.light5};
      border-top: 1px solid ${e.colors.grayscale.light2};
      border-left: 1px solid ${e.colors.grayscale.light2};
      vertical-align: top;
      text-align: right;
    }

    table.pvtTable tbody tr th.pvtRowLabel {
      vertical-align: baseline;
    }

    .pvtTotal,
    .pvtGrandTotal {
      font-weight: ${e.typography.weights.bold};
    }

    table.pvtTable tbody tr td.pvtRowTotal {
      vertical-align: middle;
    }

    .toggle-wrapper {
      white-space: nowrap;
    }

    .toggle-wrapper > .toggle-val {
      white-space: normal;
    }

    .toggle {
      padding-right: ${e.gridUnit}px;
      cursor: pointer;
    }

    .hoverable:hover {
      background-color: ${e.colors.primary.light4};
      cursor: pointer;
    }
  `}}
`,P=t=>"number"==typeof t||"string"==typeof t?t:String(t);function z(t,e,o,r,a){const s=a[r]||r;return t?(0,L.tZ)("span",{className:"toggle-wrapper"},(0,L.tZ)("span",{role:"button",tabIndex:"0",className:"toggle",onClick:o},e),(0,L.tZ)("span",{className:"toggle-val"},P(s))):P(s)}class V extends s.Component{constructor(t){super(t),this.state={collapsedRows:{},collapsedCols:{}},this.clickHeaderHandler=this.clickHeaderHandler.bind(this),this.clickHandler=this.clickHandler.bind(this)}getBasePivotSettings(){const{props:t}=this,e=t.cols,o=t.rows,r={rowTotals:!0,colTotals:!0,...t.tableOptions},a=r.rowTotals||0===e.length,s=r.colTotals||0===o.length,l=t.namesMapping||{},n={arrowCollapsed:"▲",arrowExpanded:"▼",...t.subtotalOptions},i={displayOnTop:!1,enabled:a,hideOnExpand:!1,...n.colSubtotalDisplay},c={displayOnTop:!1,enabled:s,hideOnExpand:!1,...n.rowSubtotalDisplay},h=new Z(t,{rowEnabled:c.enabled,colEnabled:i.enabled,rowPartialOnTop:c.displayOnTop,colPartialOnTop:i.displayOnTop}),u=h.getRowKeys(),p=h.getColKeys(),g={},d={},m={};let f=null;return r.clickCallback&&(u.forEach((t=>{const e=E(t);e in g||(g[e]={}),p.forEach((o=>{g[e][E(o)]=this.clickHandler(h,t,o)}))})),a&&u.forEach((t=>{d[E(t)]=this.clickHandler(h,t,[])})),s&&p.forEach((t=>{m[E(t)]=this.clickHandler(h,[],t)})),a&&s&&(f=this.clickHandler(h,[],[]))),{pivotData:h,colAttrs:e,rowAttrs:o,colKeys:p,rowKeys:u,rowTotals:a,colTotals:s,arrowCollapsed:n.arrowCollapsed,arrowExpanded:n.arrowExpanded,colSubtotalDisplay:i,rowSubtotalDisplay:c,cellCallbacks:g,rowTotalCallbacks:d,colTotalCallbacks:m,grandTotalCallback:f,namesMapping:l}}clickHandler(t,e,o){const r=this.props.cols,a=this.props.rows,s=t.getAggregator(e,o).value(),l={},n=Math.min(r.length,o.length);for(let t=0;t<n;t+=1){const e=r[t];null!==o[t]&&(l[e]=o[t])}const i=Math.min(a.length,e.length);for(let t=0;t<i;t+=1){const o=a[t];null!==e[t]&&(l[o]=e[t])}return e=>this.props.tableOptions.clickCallback(e,s,l,t)}clickHeaderHandler(t,e,o,r,a,s,l){void 0===s&&(s=!1),void 0===l&&(l=!1);const n={};for(let t=0;t<=r;t+=1){const r=o[t];n[r]=e[t]}return o=>a(o,e[r],n,t,s,l)}collapseAttr(t,e,o){return r=>{r.stopPropagation();const a=e+1,s=o.filter((t=>t.length===a)).map(E),l={};s.forEach((t=>{l[t]=!0})),t?this.setState((t=>({collapsedRows:{...t.collapsedRows,...l}}))):this.setState((t=>({collapsedCols:{...t.collapsedCols,...l}})))}}expandAttr(t,e,o){return r=>{r.stopPropagation();const a={};o.forEach((t=>{for(let o=0;o<=e;o+=1)a[E(t.slice(0,o+1))]=!1})),t?this.setState((t=>({collapsedRows:{...t.collapsedRows,...a}}))):this.setState((t=>({collapsedCols:{...t.collapsedCols,...a}})))}}toggleRowKey(t){return e=>{e.stopPropagation(),this.setState((e=>({collapsedRows:{...e.collapsedRows,[t]:!e.collapsedRows[t]}})))}}toggleColKey(t){return e=>{e.stopPropagation(),this.setState((e=>({collapsedCols:{...e.collapsedCols,[t]:!e.collapsedCols[t]}})))}}calcAttrSpans(t,e){const o=[],r=Array(e).map((()=>0));let a=Array(e).map((()=>null));for(let e=0;e<t.length;e+=1){const s=t[e],l=[];let n=0;const i=Math.min(a.length,s.length);for(;n<i&&a[n]===s[n];)l.push(-1),o[r[n]][n]+=1,n+=1;for(;n<s.length;)r[n]=e,l.push(1),n+=1;o.push(l),a=s}return o}renderColHeaderRow(t,e,o){const{rowAttrs:r,colAttrs:s,colKeys:l,visibleColKeys:n,colAttrSpans:i,rowTotals:c,arrowExpanded:h,arrowCollapsed:u,colSubtotalDisplay:p,maxColVisible:g,pivotData:d,namesMapping:m}=o,{highlightHeaderCellsOnHover:f,omittedHighlightHeaderGroups:b=[],highlightedHeaderCells:v,dateFormatters:y}=this.props.tableOptions,w=0===e&&0!==r.length?(0,L.tZ)("th",{key:"padding",colSpan:r.length,rowSpan:s.length,"aria-hidden":"true"}):null,k=p.enabled&&e!==s.length-1;let C=null,T=null;k&&(C=e+1<g?this.collapseAttr(!1,e,l):this.expandAttr(!1,e,l),T=e+1<g?h:u);const S=(0,L.tZ)("th",{key:"label",className:"pvtAxisLabel"},z(k,T,C,t,m)),O=[],x=0!==r.length?1:0;let N=0;for(;N<n.length;){const o=n[N],r=e<o.length?i[N][e]:1;let l="pvtColLabel";if(e<o.length){var A;f&&!a()(b).call(b,s[e])&&(l+=" hoverable"),v&&Array.isArray(v[s[e]])&&a()(A=v[s[e]]).call(A,o[e])&&(l+=" active");const n=1+(e===s.length-1?x:0),i=E(o.slice(0,e+1)),c=k?this.toggleColKey(i):null,p=y&&y[t]&&"function"==typeof y[t]?y[t](o[e]):o[e];O.push((0,L.tZ)("th",{className:l,key:`colKey-${i}`,colSpan:r,rowSpan:n,onClick:this.clickHeaderHandler(d,o,this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback)},z(k,this.state.collapsedCols[i]?u:h,c,p,m)))}else if(e===o.length){const t=s.length-o.length+x;O.push((0,L.tZ)("th",{className:`${l} pvtSubtotalLabel`,key:`colKeyBuffer-${E(o)}`,colSpan:r,rowSpan:t,onClick:this.clickHeaderHandler(d,o,this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback,!0)},"Subtotal"))}N+=r}const M=0===e&&c?(0,L.tZ)("th",{key:"total",className:"pvtTotalLabel",rowSpan:s.length+Math.min(r.length,1),onClick:this.clickHeaderHandler(d,[],this.props.cols,e,this.props.tableOptions.clickColumnHeaderCallback,!1,!0)},`Total (${this.props.aggregatorName})`):null,H=[w,S,...O,M];return(0,L.tZ)("tr",{key:`colAttr-${e}`},H)}renderRowHeaderRow(t){const{rowAttrs:e,colAttrs:o,rowKeys:r,arrowCollapsed:a,arrowExpanded:s,rowSubtotalDisplay:l,maxRowVisible:n,pivotData:i,namesMapping:c}=t;return(0,L.tZ)("tr",{key:"rowHdr"},e.map(((t,o)=>{const i=l.enabled&&o!==e.length-1;let h=null,u=null;return i&&(h=o+1<n?this.collapseAttr(!0,o,r):this.expandAttr(!0,o,r),u=o+1<n?s:a),(0,L.tZ)("th",{className:"pvtAxisLabel",key:`rowAttr-${o}`},z(i,u,h,t,c))})),(0,L.tZ)("th",{className:"pvtTotalLabel",key:"padding",onClick:this.clickHeaderHandler(i,[],this.props.rows,0,this.props.tableOptions.clickRowHeaderCallback,!1,!0)},0===o.length?`Total (${this.props.aggregatorName})`:null))}renderTableRow(t,e,o){const{rowAttrs:r,colAttrs:s,rowAttrSpans:l,visibleColKeys:n,pivotData:i,rowTotals:c,rowSubtotalDisplay:h,arrowExpanded:u,arrowCollapsed:p,cellCallbacks:g,rowTotalCallbacks:d,namesMapping:m}=o,{highlightHeaderCellsOnHover:f,omittedHighlightHeaderGroups:b=[],highlightedHeaderCells:v,cellColorFormatters:y,dateFormatters:w}=this.props.tableOptions,k=E(t),C=0!==s.length?1:0,T=t.map(((o,s)=>{var n;let c="pvtRowLabel";f&&!a()(b).call(b,r[s])&&(c+=" hoverable"),v&&Array.isArray(v[r[s]])&&a()(n=v[r[s]]).call(n,o)&&(c+=" active");const g=l[e][s];if(g>0){const e=E(t.slice(0,s+1)),a=1+(s===r.length-1?C:0),l=h.enabled&&s!==r.length-1,n=l?this.toggleRowKey(e):null,d=w&&w[r[s]]?w[r[s]](o):o;return(0,L.tZ)("th",{key:`rowKeyLabel-${s}`,className:c,rowSpan:g,colSpan:a,onClick:this.clickHeaderHandler(i,t,this.props.rows,s,this.props.tableOptions.clickRowHeaderCallback)},z(l,this.state.collapsedRows[e]?p:u,n,d,m))}return null})),S=t.length<r.length?(0,L.tZ)("th",{className:"pvtRowLabel pvtSubtotalLabel",key:"rowKeyBuffer",colSpan:r.length-t.length+C,rowSpan:1,onClick:this.clickHeaderHandler(i,t,this.props.rows,t.length,this.props.tableOptions.clickRowHeaderCallback,!0)},"Subtotal"):null,O=g[k]||{},x=n.map((e=>{const o=E(e),r=i.getAggregator(t,e),a=r.value(),s=[...t,...e];let l;y&&Object.values(y).forEach((t=>{Array.isArray(t)&&s.forEach((e=>{l||t.filter((t=>t.column===e)).forEach((t=>{const e=t.getColorFromValue(a);e&&(l=e)}))}))}));const n=r.isSubtotal?{fontWeight:"bold"}:{backgroundColor:l};return(0,L.tZ)("td",{role:"gridcell",className:"pvtVal",key:`pvtVal-${o}`,onClick:O[o],onContextMenu:o=>this.props.onContextMenu(o,e,t),style:n},r.format(a))}));let N=null;if(c){const e=i.getAggregator(t,[]),o=e.value();N=(0,L.tZ)("td",{role:"gridcell",key:"total",className:"pvtTotal",onClick:d[k],onContextMenu:e=>this.props.onContextMenu(e,void 0,t)},e.format(o))}const A=[...T,S,...x,N];return(0,L.tZ)("tr",{key:`keyRow-${k}`},A)}renderTotalsRow(t){const{rowAttrs:e,colAttrs:o,visibleColKeys:r,rowTotals:a,pivotData:s,colTotalCallbacks:l,grandTotalCallback:n}=t,i=(0,L.tZ)("th",{key:"label",className:"pvtTotalLabel pvtRowTotalLabel",colSpan:e.length+Math.min(o.length,1),onClick:this.clickHeaderHandler(s,[],this.props.rows,0,this.props.tableOptions.clickRowHeaderCallback,!1,!0)},`Total (${this.props.aggregatorName})`),c=r.map((t=>{const e=E(t),o=s.getAggregator([],t),r=o.value();return(0,L.tZ)("td",{role:"gridcell",className:"pvtTotal pvtRowTotal",key:`total-${e}`,onClick:l[e],onContextMenu:e=>this.props.onContextMenu(e,t,void 0),style:{padding:"5px"}},o.format(r))}));let h=null;if(a){const t=s.getAggregator([],[]),e=t.value();h=(0,L.tZ)("td",{role:"gridcell",key:"total",className:"pvtGrandTotal pvtRowTotal",onClick:n,onContextMenu:t=>this.props.onContextMenu(t,void 0,void 0)},t.format(e))}const u=[i,...c,h];return(0,L.tZ)("tr",{key:"total",className:"pvtRowTotals"},u)}visibleKeys(t,e,o,r){return t.filter((t=>!t.some(((o,r)=>e[E(t.slice(0,r))]))&&(t.length===o||E(t)in e||!r.hideOnExpand)))}render(){this.cachedProps!==this.props&&(this.cachedProps=this.props,this.cachedBasePivotSettings=this.getBasePivotSettings());const{colAttrs:t,rowAttrs:e,rowKeys:o,colKeys:r,colTotals:a,rowSubtotalDisplay:s,colSubtotalDisplay:l}=this.cachedBasePivotSettings,n=this.visibleKeys(o,this.state.collapsedRows,e.length,s),i=this.visibleKeys(r,this.state.collapsedCols,t.length,l),c={visibleRowKeys:n,maxRowVisible:Math.max(...n.map((t=>t.length))),visibleColKeys:i,maxColVisible:Math.max(...i.map((t=>t.length))),rowAttrSpans:this.calcAttrSpans(n,e.length),colAttrSpans:this.calcAttrSpans(i,t.length),...this.cachedBasePivotSettings};return(0,L.tZ)(D,null,(0,L.tZ)("table",{className:"pvtTable",role:"grid"},(0,L.tZ)("thead",null,t.map(((t,e)=>this.renderColHeaderRow(t,e,c))),0!==e.length&&this.renderRowHeaderRow(c)),(0,L.tZ)("tbody",null,n.map(((t,e)=>this.renderTableRow(t,e,c))),a&&this.renderTotalsRow(c))))}}V.propTypes={...Z.propTypes,tableOptions:v().object,onContextMenu:v().func},V.defaultProps={...Z.defaultProps,tableOptions:{}};class j extends s.PureComponent{render(){return(0,L.tZ)(V,this.props)}}j.propTypes=V.propTypes,j.defaultProps=V.defaultProps;const q=j;var U=o(86769);const I=g.iK.div`
  ${t=>{let{height:e,width:o,margin:r}=t;return`\n      margin: ${r}px;\n      height: ${e-2*r}px;\n      width: ${"string"==typeof o?parseInt(o,10):o-2*r}px;\n `}}
`,B=g.iK.div`
  height: 100%;
  max-width: fit-content;
  overflow: auto;
`,G="metric",J=["value"],W=(0,g.iK)(c)`
  stroke: ${t=>{let{theme:e}=t;return e.colors.grayscale.light2}};
  stroke-width: 16px;
`,Q=(0,g.iK)(p)`
  stroke: ${t=>{let{theme:e}=t;return e.colors.grayscale.light2}};
  stroke-width: 16px;
`,X=t=>({Count:K.count(t),"Count Unique Values":K.countUnique(t),"List Unique Values":K.listUnique(", ",t),Sum:K.sum(t),Average:K.average(t),Median:K.median(t),"Sample Variance":K.var(1,t),"Sample Standard Deviation":K.stdev(1,t),Minimum:K.min(t),Maximum:K.max(t),First:K.first(t),Last:K.last(t),"Sum as Fraction of Total":K.fractionOf(K.sum(),"total",t),"Sum as Fraction of Rows":K.fractionOf(K.sum(),"row",t),"Sum as Fraction of Columns":K.fractionOf(K.sum(),"col",t),"Count as Fraction of Total":K.fractionOf(K.count(),"total",t),"Count as Fraction of Rows":K.fractionOf(K.count(),"row",t),"Count as Fraction of Columns":K.fractionOf(K.count(),"col",t)});function Y(t){const{data:e,height:o,width:r,groupbyRows:l,groupbyColumns:n,metrics:i,colOrder:c,rowOrder:h,aggregateFunction:u,transposePivot:p,combineMetric:b,rowSubtotalPosition:v,colSubtotalPosition:y,colTotals:w,rowTotals:k,valueFormat:C,emitFilter:T,setDataMask:S,selectedFilters:x,verboseMap:N,columnFormats:A,metricsLayout:M,metricColorFormatters:H,dateFormatters:R,onContextMenu:F}=t,K=(0,g.Fg)(),_=(0,s.useMemo)((()=>(0,d.JB)(C)),[C]),$=(0,s.useMemo)((()=>Object.entries(A)),[A]),E=$.length>0,Z=(0,s.useMemo)((()=>E?{[G]:Object.fromEntries($.map((t=>{let[e,o]=t;return[e,(0,d.JB)(o)]})))}:void 0),[$,E]),D=(0,s.useMemo)((()=>i.map((t=>"string"==typeof t?t:t.label))),[i]),P=(0,s.useMemo)((()=>e.reduce(((t,e)=>[...t,...D.map((t=>({...e,[G]:t,value:e[t]}))).filter((t=>null!==t.value))]),[])),[e,D]),z=(0,s.useMemo)((()=>l.map(m.Z)),[l]),V=(0,s.useMemo)((()=>n.map(m.Z)),[n]),j=(0,s.useMemo)((()=>({[G]:O(D)})),[D]),[Y,tt]=(0,s.useMemo)((()=>{let[t,e]=p?[V,z]:[z,V];return M===U.Q.ROWS?t=b?[...t,G]:[G,...t]:e=b?[...e,G]:[G,...e],[t,e]}),[b,V,z,M,p]),et=(0,s.useCallback)((t=>{const e=Object.keys(t),o=[...l,...n];S({extraFormData:{filters:0===e.length?void 0:e.map((e=>{var r;const a=null==t?void 0:t[e],s=null!=(r=o.find((t=>(0,f.s9)(t)?t===e:!!(0,f.GA)(t)&&t.label===e)))?r:"";return null==a?{col:s,op:"IS NULL"}:{col:s,op:"IN",val:a}}))},filterState:{value:t&&Object.keys(t).length?Object.values(t):null,selectedFilters:t&&Object.keys(t).length?t:null}})}),[n,l,S]),ot=(0,s.useCallback)(((t,e,o,r,s,l)=>{if(s||l||!T)return;const n={...o};delete n.metric;const i=Object.entries(n);if(0===i.length)return;const[c,h]=i[i.length-1];let u={...x||{}};u=x&&((t,e)=>{var o;return!!x&&(null==(o=x[t])?void 0:a()(o).call(o,e))})(c,h)?{}:{[c]:[h]},Array.isArray(u[c])&&0===u[c].length&&delete u[c],et(u)}),[T,x,et]),rt=(0,s.useMemo)((()=>({clickRowHeaderCallback:ot,clickColumnHeaderCallback:ot,colTotals:w,rowTotals:k,highlightHeaderCellsOnHover:T,highlightedHeaderCells:x,omittedHighlightHeaderGroups:[G],cellColorFormatters:{[G]:H},dateFormatters:R})),[w,R,T,H,k,x,ot]),at=(0,s.useMemo)((()=>({colSubtotalDisplay:{displayOnTop:y},rowSubtotalDisplay:{displayOnTop:v},arrowCollapsed:(0,L.tZ)(W,null),arrowExpanded:(0,L.tZ)(Q,null)})),[y,v]),st=(0,s.useCallback)(((t,e,o)=>{if(F){t.preventDefault();const r=[];e&&e.length>1&&e.forEach(((t,e)=>{var o;const a=tt[e],s=(null==(o=R[a])?void 0:o.call(R,t))||String(t);e>0&&r.push({col:a,op:"==",val:t,formattedVal:s})})),o&&o.forEach(((t,e)=>{var o;const a=Y[e],s=(null==(o=R[a])?void 0:o.call(R,t))||String(t);r.push({col:a,op:"==",val:t,formattedVal:s})})),F(r,t.clientX,t.clientY)}}),[tt,R,F,Y]);return(0,L.tZ)(I,{height:o,width:r,margin:4*K.gridUnit},(0,L.tZ)(B,null,(0,L.tZ)(q,{data:P,rows:Y,cols:tt,aggregatorsFactory:X,defaultFormatter:_,customFormatters:Z,aggregatorName:u,vals:J,colOrder:c,rowOrder:h,sorters:j,tableOptions:rt,subtotalOptions:at,namesMapping:N,onContextMenu:st})))}}}]);
//# sourceMappingURL=ebd44cb8daa7156286d5.chunk.js.map